{"version":3,"file":"bundle.js","mappings":"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","sources":["webpack://08-js-service-calls/./src/services.js","webpack://08-js-service-calls/webpack/bootstrap","webpack://08-js-service-calls/webpack/runtime/define property getters","webpack://08-js-service-calls/webpack/runtime/hasOwnProperty shorthand","webpack://08-js-service-calls/webpack/runtime/make namespace object","webpack://08-js-service-calls/./src/index.js"],"sourcesContent":["// This is a sample file that demonstrates\r\n// how you can write an abstraction around\r\n// a fetch() call\r\n// This exported function returns a promise\r\n// that resolves with data\r\n// or rejects with an error object\r\n//\r\n// The caller of this function can decide\r\n// what to do with the data\r\n// or what to do with the error\r\n//\r\n// You can add to this file and use this function\r\n// or write your own files/functions\r\n\r\n\r\n\r\nexport function getLogin() {\r\n\r\n  return fetch('/api/session/', {\r\n    method: 'GET',\r\n    headers: {\r\n      'content-type': 'application/json', \r\n    },\r\n  })\r\n  .catch( err => Promise.reject({ error: 'network-error' }) )\r\n  .then( response => {\r\n    if(!response.ok) {  \r\n      return response.json().then( err => Promise.reject(err) );\r\n    }\r\n    return response.json(); \r\n  });\r\n\r\n}\r\n\r\n\r\nexport function fetchLogin(username) {\r\n\r\n  return fetch('/api/session/', {\r\n    method: 'POST',\r\n    headers: {\r\n      'content-type': 'application/json', \r\n    },\r\n    body: JSON.stringify( { username } ),\r\n  })\r\n  .catch( err => Promise.reject({ error: 'network-error' }) )\r\n  .then( response => {\r\n    if(!response.ok) {  \r\n      return response.json().then( err => Promise.reject(err) );\r\n    }\r\n    return response.json(); \r\n  });\r\n}\r\n\r\nexport function getWord() {\r\n\r\n  return fetch('/api/word/', {\r\n    method: 'GET',\r\n    headers: {\r\n      'content-type': 'application/json', \r\n    },\r\n  })\r\n  .catch( err => Promise.reject({ error: 'network-error' }) )\r\n  .then( response => {\r\n    if(!response.ok) {  \r\n      return response.json().then( err => Promise.reject(err) );\r\n    }\r\n    return response.json(); \r\n  });\r\n\r\n}\r\n\r\n\r\nexport function fetchWord(word) {\r\n  return fetch('/api/word/', {\r\n    method: 'POST',\r\n    headers: {\r\n      'content-type': 'application/json', \r\n    },\r\n    body: JSON.stringify( { word } ),\r\n  })\r\n  .catch( err => Promise.reject({ error: 'network-error' }) )\r\n  .then( response => {\r\n    if(!response.ok) {  \r\n      return response.json().then( err => Promise.reject(err) );\r\n    }\r\n    return response.json(); \r\n  });\r\n}\r\n\r\n\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { fetchLogin,getLogin,fetchWord,getWord } from \"./services\";\nconst dialog = document.querySelector('dialog');\nconst app = document.querySelector('#app');\nonPageLoad();\n\n// Collect the msg corresponding to different errors\nfunction showError(err) {\n  let message;\n\n  switch (err.error) {\n    case 'required-username':\n      message = 'Username cannot be empty or contain special character besides underscore!';\n      break;\n    case 'auth-insufficient':\n      message = 'Your password is not correct!';\n      break;\n    case 'required-word':\n      message = 'Word cannot be empty!';\n      break;\n    case 'invalid-word':\n      message = 'Word cannot contain any character besides lowercase or uppercase letters!';\n      break;\n  }\n// Use dialogue to imform erorrs\n  dialog.showModal();\n  dialog.querySelector('p').textContent = message;\n}\n\n// generate name list in the chat room\nfunction generateNameList(session){\n  const recordName = [];\n  \n  Object.keys(session).map((sid)=>{ \n      const name = session[sid].username;\n      \n      if(recordName.indexOf(name)<0){\n          recordName.push(name)}});\n     \n  \n      return recordName.map((name)=>{\n            return `<li>${name}</li>`\n          }).join('');       \n     \n  }\n\n//generate messages in the chat room\n\nfunction generateMessageList(session,messages){\n\n  const messageList = messages.map((message)=>{\n\n    const sid = message[0];\n    const word = message[1];\n    return `<li>${session[sid].username}:${word}</li>`\n\n  }).join(' ');\n\n    return messageList;         \n\n}\n\n// load the page\nfunction onPageLoad() {\n\ngetLogin()\n.then(response=>{renderWord(app)})\n.catch (error=>{\n    renderLogin(app);\n})\n}\n\n// login page\nfunction renderLogin(container) {\ncontainer.innerHTML = `\n  <form class='app__form' name='login'>\n    <label>\n      Username: \n      <input type='text' name='username'/>\n    </label>\n    <label>\n      Password: \n      <input type='password' name='password'/>\n    </label>\n    <button type='submit'>\n      Login\n    </button>\n  </form>\n`;\n\nconst form = document.forms.login;\n\n// submit the username\nform.onsubmit =  (event) => {\n  event.preventDefault();\n  const username = form.username.value;\n\n  fetchLogin(username)\n  .then((response)=>renderWord(app))\n  .catch(err=>showError(err))\n}\n}\n\n// chat room\nfunction renderWord(container) {\n\ncontainer.innerHTML = `\n  <form name='word' class = \"chat__form\">\n    <label>\n      Current User:\n      <ul class ='user'></ul>\n    </label>\n    <label>\n      Saved Word:\n      <ul class ='messages'></ul>\n    </label>\n    <label>\n      Send Mesage: \n      <input class = \"message\"/>\n    </label>\n    <label>\n      <button type='submit' name='submit'>\n        Send\n      </button>\n      <button type='button' name='logout'>\n        Log Out\n      </button>\n    </label>\n  </form>\n`;\n\nconst form = document.forms.word;\nconst user = document.querySelector(\".user\");\nconst messages = document.querySelector(\".messages\");\n\n// Refresh the page\n  function refresh(user,messages){\n    getWord()\n    .then((response)=>\n    // show message lists and name lists\n      {user.innerHTML = generateNameList(response.session);\n       messages.innerHTML = generateMessageList(response.record,response.messages)         \n      })\n    .catch(error=>renderLogin(app))  \n      \n  }\n\n// set the timeout as 5s and break it when it goes back to the login page  \n   function refreshChatRoom(){\n\n      refresh(user,messages);\n      const timeout = setTimeout(refreshChatRoom,5000);\n      \n      if(!document.forms.word){\n        clearTimeout(timeout);\n      }\n      \n    }\n\n      refreshChatRoom();\n    \n// log out \nform.onsubmit =  (event) => {\n\n  event.preventDefault();\n  const message = document.querySelector(\".message\").value; \n  fetchWord(message)\n  // delete the session\n  .then((response)=>messages.innerHTML = generateMessageList(response.record,response.messages))\n  .catch(error=>showError(error))\n}\n\nform.logout.onclick =  (event) => {\n  fetch('/api/session', { method: 'DELETE' });\n  renderLogin(app); \n}\n}\n"],"names":["getLogin","fetch","method","headers","err","Promise","reject","error","then","response","ok","json","fetchLogin","username","body","JSON","stringify","getWord","fetchWord","word","dialog","document","querySelector","app","onPageLoad","showError","message","showModal","textContent","generateNameList","session","recordName","Object","keys","map","sid","name","indexOf","push","concat","join","generateMessageList","messages","messageList","renderWord","renderLogin","container","innerHTML","form","forms","login","onsubmit","event","preventDefault","value","user","refresh","record","refreshChatRoom","timeout","setTimeout","clearTimeout","logout","onclick"],"sourceRoot":""}